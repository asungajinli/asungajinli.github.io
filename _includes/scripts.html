{% if site.footer_scripts %}
  {% for script in site.footer_scripts %}
    <script src="{{ script | relative_url }}"></script>
  {% endfor %}
{% else %}
  <script src="{{ '/assets/js/main.min.js' | relative_url }}"></script>
{% endif %}

<!-- bootstrap -->
<!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script> -->

{% if site.search == true or page.layout == "search" %}
  {%- assign search_provider = site.search_provider | default: "lunr" -%}
  {%- case search_provider -%}
    {%- when "lunr" -%}
      {% include_cached search/lunr-search-scripts.html %}
    {%- when "google" -%}
      {% include_cached search/google-search-scripts.html %}
    {%- when "algolia" -%}
      {% include_cached search/algolia-search-scripts.html %}
  {%- endcase -%}
{% endif %}

{% include analytics.html %}
{% include /comments-providers/scripts.html %}

{% if site.after_footer_scripts %}
  {% for script in site.after_footer_scripts %}
    <script src="{{ script | relative_url }}"></script>
  {% endfor %}
{% endif %}

<!-- mathjax -->
<script type="text/javascript" async
	src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML">
</script>

<script type="text/x-mathjax-config">
   MathJax.Hub.Config({
     extensions: ["tex2jax.js"],
     jax: ["input/TeX", "output/HTML-CSS"],
     tex2jax: {
       inlineMath: [ ['$','$'], ["\\(","\\)"] ],
       displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
       processEscapes: true
     },
     "HTML-CSS": { availableFonts: ["TeX"] }
   });
</script>

<!-- include html -->
<script>
  window.addEventListener('load', function() {
      var allElements = document.getElementsByTagName('*');
      Array.prototype.forEach.call(allElements, function(el) {
          var includePath = el.dataset.includePath;
          if (includePath) {
              var xhttp = new XMLHttpRequest();
              xhttp.onreadystatechange = function () {
                  if (this.readyState == 4 && this.status == 200) {
                      el.outerHTML = this.responseText;
                  }
              };
              xhttp.open('GET', includePath, true);
              xhttp.send();
          }
      });
  });
</script>

<!-- 404.html -->
<script>
  var pageX = $(document).width();
  var pageY = $(document).height();
  var mouseY=0;
  var mouseX=0;

  $(document).mousemove(function( event ) {
  //verticalAxis
  mouseY = event.pageY;
  yAxis = (pageY-mouseY)/pageY*200;
  //horizontalAxis
  mouseX = event.pageX / -pageX;
  xAxis = -mouseX * 100 - 100;

  $('.box__ghost-eyes').css({ 'transform': 'translate('+ xAxis +'%,-'+ yAxis +'%)' });

  //console.log('X: ' + xAxis);

  });
</script>

<!-- football -->

<!-- top scroll button -->
<script>
  var topbtn = $('#topbutton');

  $(window).scroll(function() {
    if ($(window).scrollTop() > 600) {
      topbtn.addClass('show');
    } else {
      topbtn.removeClass('show');
    }
  });

  topbtn.on('click', function(e) {
    e.preventDefault();
    $('html, body').animate({scrollTop:0}, 400);
  });
</script>

<script>
    var initialScale = 1;
    var scaleStep = 0.1;
    var isZooming = false;
    var currentScale = initialScale;
    var isDragging = false;
    var startX, startY;
    var translateX = 0;
    var translateY = 0;
    $(document).ready(function() {
        $('.gallery-img').on('click', function() {
            var imgSrc = $(this).attr('src');
            var imgAlt = $(this).attr('alt');
            $('#modalImg').attr('src', imgSrc);
            $('#caption').text(imgAlt);
            $('#myModal').fadeIn();
            adjustModalSize();
            $(document).mousedown(function(e) {
                var modalContent = $('.modal-content');
                if (!modalContent.is(e.target) && modalContent.has(e.target).length === 0) {
                    $('#myModal').fadeOut('fast');
                }
            });
        });
        $('.close').on('click', function() {
            $('#myModal').fadeOut('fast');
        });
        $(window).on('resize', function() {
            adjustModalSize();
        });
        $('.modal-content').on('wheel', function(e) {
          if (e.ctrlKey) {
            e.preventDefault();

            if (!isZooming) {
              isZooming = true;
              var delta = e.originalEvent.deltaY;

              while(1) {
                if (delta < 0 ) {
                  zoomIn();
                } else {
                  zoomOut();
                }
                delta += delta;
                console.log(delta)
                if (delta < -200 || delta > 200) {
                  break;
                }
              }
            }
          }
        });
        $('.modal-content').on('mouseenter', function(e) {
          $(this).css('cursor', 'grab'); // 드래그 가능한 요소에 호버할 때 커서 스타일 변경
        });
        $('.modal-content').on('mousedown', function(e) {
          isDragging = true;
          startX = e.clientX;
          startY = e.clientY;
          $(this).css('cursor', 'grabbing'); // 드래그 중일 때 커서 스타일 변경
        });
        $(document).on('mousemove', function(e) {
          if (isDragging) {
            requestAnimationFrame(function() {
              var deltaX = e.clientX - startX;
              var deltaY = e.clientY - startY;

              translateX += deltaX;
              translateY += deltaY;

              $('.modal-content').css('transform', 'translate(' + translateX + 'px, ' + translateY + 'px) scale(' + currentScale + ')');

              startX = e.clientX;
              startY = e.clientY;
            });
          }
        });
        $(document).on('mouseup', function() {
          isDragging = false;
          $('.modal-content').css('cursor', 'grab'); // 드래그 종료 후 커서 스타일 변경
        });
    });

    function zoomIn() {
        if (currentScale >= 5) {
            isZooming = false;
            return;
        }
        var newScale = currentScale + scaleStep;
        adjustModalSize(newScale);
        currentScale = newScale;
        isZooming = false;
    }

    function zoomOut(count) {
        if (currentScale <= 0.7) {
            isZooming = false;
            return;
        }
        var newScale = currentScale - scaleStep;
        adjustModalSize(newScale);
        currentScale = newScale;
        isZooming = false;
    }

    function adjustModalSize(scale = 1) {
        var modalContent = $('.modal-content');
        var windowWidth = $(window).width();
        var windowHeight = $(window).height();
        var maxWidth = windowWidth * 0.95;
        var maxHeight = windowHeight * 0.9;
        var img = new Image();
        img.src = $('#modalImg').attr('src');
        img.onload = function() {
            var modalWidth = img.width;
            var modalHeight = img.height;
            if (modalWidth > maxWidth || modalHeight > maxHeight) {
                var widthRatio = maxWidth / modalWidth;
                var heightRatio = maxHeight / modalHeight;
                var scaleRatio = Math.min(widthRatio, heightRatio);
                modalWidth = modalWidth * scaleRatio;
                modalHeight = modalHeight * scaleRatio;
            }
            modalContent.css({
                width: modalWidth + 'px',
                height: modalHeight + 'px',
                'top': (windowHeight - modalHeight*1.2) / 2 + 'px',
                transform: 'scale(' + scale + ')'
            });
            initialScale = scale;
            currentScale = scale;
        };
    }

</script>